# BS æ¶æ„æŠ€æœ¯é€‰å‹æ¨è

## æ–‡æ¡£ä¿¡æ¯

- **é¡¹ç›®åç§°**: Holder PAAS PC
- **æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0
- **åˆ›å»ºæ—¥æœŸ**: 2024å¹´
- **æ–‡æ¡£ç±»å‹**: æŠ€æœ¯æ¶æ„é€‰å‹

---

## ç›®å½•

1. [é€‰å‹åŸåˆ™](#é€‰å‹åŸåˆ™)
2. [æ ¸å¿ƒæŠ€æœ¯æ ˆ](#æ ¸å¿ƒæŠ€æœ¯æ ˆ)
3. [è¯¦ç»†æŠ€æœ¯é€‰å‹](#è¯¦ç»†æŠ€æœ¯é€‰å‹)
4. [æŠ€æœ¯æ ˆå¯¹æ¯”](#æŠ€æœ¯æ ˆå¯¹æ¯”)
5. [è¿ç§»å»ºè®®](#è¿ç§»å»ºè®®)
6. [ç¤ºä¾‹ä»£ç ](#ç¤ºä¾‹ä»£ç )

---

## é€‰å‹åŸåˆ™

### 1. å…¼å®¹æ€§åŸåˆ™
- âœ… ä¼˜å…ˆè€ƒè™‘ä¸ç°æœ‰æŠ€æœ¯æ ˆå…¼å®¹
- âœ… é™ä½è¿ç§»æˆæœ¬å’Œé£é™©
- âœ… ä¿æŒä»£ç é£æ ¼ä¸€è‡´æ€§

### 2. æˆç†Ÿç¨³å®šåŸåˆ™
- âœ… é€‰æ‹©æˆç†Ÿç¨³å®šçš„æŠ€æœ¯æ–¹æ¡ˆ
- âœ… ç¤¾åŒºæ´»è·ƒï¼Œæ–‡æ¡£å®Œå–„
- âœ… é•¿æœŸç»´æŠ¤æ”¯æŒ

### 3. æ€§èƒ½ä¼˜å…ˆåŸåˆ™
- âœ… é€‰æ‹©é«˜æ€§èƒ½çš„æŠ€æœ¯æ–¹æ¡ˆ
- âœ… æ”¯æŒä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½
- âœ… ä¼˜åŒ–æ‰“åŒ…ä½“ç§¯

### 4. å¼€å‘ä½“éªŒåŸåˆ™
- âœ… å¼€å‘å·¥å…·å®Œå–„
- âœ… TypeScript æ”¯æŒè‰¯å¥½
- âœ… è°ƒè¯•æ–¹ä¾¿

---

## æ ¸å¿ƒæŠ€æœ¯æ ˆ

### æ¨èæŠ€æœ¯æ ˆæ€»è§ˆ

| æŠ€æœ¯åˆ†ç±» | æ¨èæ–¹æ¡ˆ | ç‰ˆæœ¬ | è¯´æ˜ |
|---------|---------|------|------|
| **å‰ç«¯æ¡†æ¶** | React | 18.2+ | å‡çº§åˆ°æœ€æ–°ç¨³å®šç‰ˆ |
| **å¼€å‘è¯­è¨€** | TypeScript | 5.0+ | å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ |
| **çŠ¶æ€ç®¡ç†** | Redux Toolkit + Zustand | RTK 2.0+ / Zustand 4.5+ | åŒçŠ¶æ€ç®¡ç†æ–¹æ¡ˆ |
| **è·¯ç”±ç®¡ç†** | React Router | 6.20+ | å‡çº§åˆ° v6 |
| **UI ç»„ä»¶åº“** | Ant Design | 5.12+ | å‡çº§åˆ° v5 |
| **HTTP å®¢æˆ·ç«¯** | Axios | 1.6+ | ä¿æŒä½¿ç”¨ |
| **WebSocket** | åŸç”Ÿ WebSocket + ReconnectingWebSocket | - | è‡ªå®šä¹‰å°è£… |
| **æ•°æ®å­˜å‚¨** | Dexie.js | 3.2+ | IndexedDB å°è£… |
| **æ„å»ºå·¥å…·** | Vite | 5.0+ | æ¨èä½¿ç”¨ Vite |
| **æ ·å¼æ–¹æ¡ˆ** | Less + CSS Modules | - | ä¿æŒç°æœ‰æ–¹æ¡ˆ |
| **æµ‹è¯•æ¡†æ¶** | Vitest + React Testing Library | - | ç°ä»£åŒ–æµ‹è¯•æ–¹æ¡ˆ |
| **PWA æ”¯æŒ** | Vite PWA Plugin | 0.17+ | PWA æ”¯æŒ |

---

## è¯¦ç»†æŠ€æœ¯é€‰å‹

### 1. å‰ç«¯æ¡†æ¶

#### 1.1 React

**æ¨èç‰ˆæœ¬**: **React 18.2+**

**é€‰å‹ç†ç”±**:
- âœ… å½“å‰ä½¿ç”¨ React 16.13.1ï¼Œå‡çº§åˆ° 18.2+ å¯è·å¾—ï¼š
  - Concurrent Modeï¼ˆå¹¶å‘æ¨¡å¼ï¼‰
  - Automatic Batchingï¼ˆè‡ªåŠ¨æ‰¹å¤„ç†ï¼‰
  - Suspense æ”¹è¿›
  - æ›´å¥½çš„æ€§èƒ½
- âœ… å‘åå…¼å®¹ï¼Œè¿ç§»æˆæœ¬ä½
- âœ… ç¤¾åŒºæ´»è·ƒï¼Œç”Ÿæ€å®Œå–„

**è¿ç§»å»ºè®®**:
```typescript
// æ¸è¿›å¼å‡çº§ï¼Œå…ˆå‡çº§åˆ° 17.xï¼Œå†å‡çº§åˆ° 18.x
// React 18 ä¸»è¦å˜åŒ–ï¼š
// 1. createRoot API
import { createRoot } from 'react-dom/client'

const root = createRoot(document.getElementById('root')!)
root.render(<App />)

// 2. è‡ªåŠ¨æ‰¹å¤„ç†
// 3. Suspense æ”¹è¿›
```

**æ›¿ä»£æ–¹æ¡ˆ**: 
- âŒ Vue 3ï¼ˆè¿ç§»æˆæœ¬é«˜ï¼‰
- âŒ Angularï¼ˆè¿ç§»æˆæœ¬é«˜ï¼‰

---

### 2. çŠ¶æ€ç®¡ç†

#### 2.1 Redux Toolkitï¼ˆæ¨èç”¨äºå…¨å±€çŠ¶æ€ï¼‰

**æ¨èç‰ˆæœ¬**: **@reduxjs/toolkit 2.0+**

**é€‰å‹ç†ç”±**:
- âœ… å½“å‰é¡¹ç›®å·²ä½¿ç”¨ Redux 4.0.5
- âœ… Redux Toolkit æ˜¯ Redux å®˜æ–¹æ¨èæ–¹æ¡ˆ
- âœ… ç®€åŒ– Redux ä½¿ç”¨ï¼Œå‡å°‘æ ·æ¿ä»£ç 
- âœ… å†…ç½® Immerï¼Œæ”¯æŒä¸å¯å˜æ›´æ–°
- âœ… TypeScript æ”¯æŒä¼˜ç§€

**ä½¿ç”¨åœºæ™¯**:
- å…¨å±€åº”ç”¨çŠ¶æ€ï¼ˆç”¨æˆ·ä¿¡æ¯ã€ç»„ç»‡ä¿¡æ¯ç­‰ï¼‰
- éœ€è¦æ—¶é—´æ—…è¡Œè°ƒè¯•çš„çŠ¶æ€
- éœ€è¦ä¸­é—´ä»¶çš„å¤æ‚çŠ¶æ€ç®¡ç†

**ç¤ºä¾‹ä»£ç **:
```typescript
// store/slices/userSlice.ts
import { createSlice, PayloadAction } from '@reduxjs/toolkit'

interface UserState {
  userInfo: UserInfo | null
  loginToken: string | null
  loading: boolean
}

const initialState: UserState = {
  userInfo: null,
  loginToken: null,
  loading: false,
}

const userSlice = createSlice({
  name: 'user',
  initialState,
  reducers: {
    setUserInfo: (state, action: PayloadAction<UserInfo>) => {
      state.userInfo = action.payload
    },
    setLoginToken: (state, action: PayloadAction<string>) => {
      state.loginToken = action.payload
    },
    setLoading: (state, action: PayloadAction<boolean>) => {
      state.loading = action.payload
    },
  },
})

export const { setUserInfo, setLoginToken, setLoading } = userSlice.actions
export default userSlice.reducer
```

---

#### 2.2 Zustandï¼ˆæ¨èç”¨äºç»„ä»¶çº§çŠ¶æ€ï¼‰

**æ¨èç‰ˆæœ¬**: **zustand 4.5+**

**é€‰å‹ç†ç”±**:
- âœ… é¡¹ç›®ä¾èµ–ä¸­å·²æœ‰ zustand 4.5.6
- âœ… è½»é‡çº§ï¼ŒAPI ç®€æ´
- âœ… æ€§èƒ½ä¼˜ç§€ï¼Œæ— éœ€ Provider
- âœ… TypeScript æ”¯æŒä¼˜ç§€
- âœ… é€‚åˆç»„ä»¶çº§çŠ¶æ€ç®¡ç†

**ä½¿ç”¨åœºæ™¯**:
- ç»„ä»¶çº§çŠ¶æ€ç®¡ç†
- è¡¨å•çŠ¶æ€
- UI çŠ¶æ€ï¼ˆModalã€Drawer ç­‰ï¼‰
- ä¸´æ—¶çŠ¶æ€

**ç¤ºä¾‹ä»£ç **:
```typescript
// stores/uiStore.ts
import { create } from 'zustand'

interface UIState {
  sidebarOpen: boolean
  currentModal: string | null
  toggleSidebar: () => void
  openModal: (modalId: string) => void
  closeModal: () => void
}

export const useUIStore = create<UIState>((set) => ({
  sidebarOpen: true,
  currentModal: null,
  toggleSidebar: () => set((state) => ({ sidebarOpen: !state.sidebarOpen })),
  openModal: (modalId) => set({ currentModal: modalId }),
  closeModal: () => set({ currentModal: null }),
}))
```

---

#### 2.3 React Queryï¼ˆæ¨èç”¨äºæœåŠ¡ç«¯çŠ¶æ€ï¼‰

**æ¨èç‰ˆæœ¬**: **@tanstack/react-query 5.0+**

**é€‰å‹ç†ç”±**:
- âœ… ä¸“é—¨å¤„ç†æœåŠ¡ç«¯çŠ¶æ€
- âœ… å†…ç½®ç¼“å­˜ã€é‡è¯•ã€åˆ·æ–°æœºåˆ¶
- âœ… å‡å°‘æ ·æ¿ä»£ç 
- âœ… æ€§èƒ½ä¼˜ç§€

**ä½¿ç”¨åœºæ™¯**:
- API æ•°æ®è·å–å’Œç¼“å­˜
- æœåŠ¡ç«¯çŠ¶æ€åŒæ­¥
- æ•°æ®é¢„åŠ è½½

**ç¤ºä¾‹ä»£ç **:
```typescript
// hooks/useMessages.ts
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'
import { messageApi } from '@/api/message'

export const useMessages = (roomId: string) => {
  return useQuery({
    queryKey: ['messages', roomId],
    queryFn: () => messageApi.getMessages(roomId),
    staleTime: 5 * 60 * 1000, // 5åˆ†é’Ÿ
  })
}

export const useSendMessage = () => {
  const queryClient = useQueryClient()
  
  return useMutation({
    mutationFn: messageApi.sendMessage,
    onSuccess: (data, variables) => {
      // æ›´æ–°ç¼“å­˜
      queryClient.invalidateQueries({ queryKey: ['messages', variables.roomId] })
    },
  })
}
```

---

**çŠ¶æ€ç®¡ç†æ–¹æ¡ˆæ€»ç»“**:

| æ–¹æ¡ˆ | ä½¿ç”¨åœºæ™¯ | æ¨èåº¦ |
|------|---------|--------|
| **Redux Toolkit** | å…¨å±€çŠ¶æ€ã€å¤æ‚çŠ¶æ€ | â­â­â­â­â­ |
| **Zustand** | ç»„ä»¶çº§çŠ¶æ€ã€UIçŠ¶æ€ | â­â­â­â­â­ |
| **React Query** | æœåŠ¡ç«¯çŠ¶æ€ã€APIæ•°æ® | â­â­â­â­â­ |
| **Context API** | ç®€å•çŠ¶æ€ã€ä¸»é¢˜é…ç½® | â­â­â­ |

---

### 3. è·¯ç”±ç®¡ç†

#### 3.1 React Router

**æ¨èç‰ˆæœ¬**: **react-router-dom 6.20+**

**é€‰å‹ç†ç”±**:
- âœ… å½“å‰ä½¿ç”¨ React Router 5.1.2
- âœ… React Router 6 æ˜¯å®˜æ–¹æ¨èç‰ˆæœ¬
- âœ… API æ›´ç®€æ´ï¼Œæ€§èƒ½æ›´å¥½
- âœ… æ”¯æŒæ•°æ®åŠ è½½å’Œé”™è¯¯å¤„ç†
- âœ… TypeScript æ”¯æŒä¼˜ç§€

**ä¸»è¦å˜åŒ–**:
```typescript
// React Router 5
import { BrowserRouter, Route, Switch } from 'react-router-dom'

// React Router 6
import { BrowserRouter, Routes, Route } from 'react-router-dom'

// v6 ç¤ºä¾‹
<BrowserRouter>
  <Routes>
    <Route path="/" element={<Home />} />
    <Route path="/workDesk" element={<WorkDesk />} />
    <Route path="/chat" element={<Chat />} />
  </Routes>
</BrowserRouter>
```

**è¿ç§»å»ºè®®**:
- é€æ­¥è¿ç§»ï¼Œå…ˆè¿ç§»æ–°é¡µé¢
- ä½¿ç”¨ `useNavigate` æ›¿ä»£ `useHistory`
- ä½¿ç”¨ `element` æ›¿ä»£ `component`

---

### 4. UI ç»„ä»¶åº“

#### 4.1 Ant Design

**æ¨èç‰ˆæœ¬**: **antd 5.12+**

**é€‰å‹ç†ç”±**:
- âœ… å½“å‰ä½¿ç”¨ Ant Design 4.18.4
- âœ… Ant Design 5 æ€§èƒ½æ›´å¥½ï¼Œä½“ç§¯æ›´å°
- âœ… è®¾è®¡ç³»ç»Ÿå®Œå–„
- âœ… TypeScript æ”¯æŒä¼˜ç§€
- âœ… ç»„ä»¶ä¸°å¯Œï¼Œæ–‡æ¡£å®Œå–„

**ä¸»è¦å˜åŒ–**:
- CSS-in-JSï¼ˆä½¿ç”¨ emotionï¼‰
- æ›´å¥½çš„ TypeScript æ”¯æŒ
- æ€§èƒ½ä¼˜åŒ–
- ä¸»é¢˜å®šåˆ¶æ›´çµæ´»

**è¿ç§»å»ºè®®**:
- æ¸è¿›å¼å‡çº§ï¼Œå…ˆå‡çº§åˆ° 5.x
- æ³¨æ„æ ·å¼å˜åŒ–ï¼Œå¯èƒ½éœ€è¦è°ƒæ•´
- ä½¿ç”¨æ–°çš„ä¸»é¢˜å®šåˆ¶ API

---

### 5. HTTP å®¢æˆ·ç«¯

#### 5.1 Axios

**æ¨èç‰ˆæœ¬**: **axios 1.6+**

**é€‰å‹ç†ç”±**:
- âœ… å½“å‰é¡¹ç›®ä½¿ç”¨ axios
- âœ… åŠŸèƒ½å®Œå–„ï¼Œæ‹¦æˆªå™¨æ”¯æŒå¥½
- âœ… è¯·æ±‚/å“åº”æ‹¦æˆªå™¨
- âœ… å–æ¶ˆè¯·æ±‚æ”¯æŒ
- âœ… TypeScript æ”¯æŒè‰¯å¥½

**å°è£…å»ºè®®**:
```typescript
// api/request.ts
import axios, { AxiosInstance, AxiosRequestConfig } from 'axios'

const apiClient: AxiosInstance = axios.create({
  baseURL: process.env.API_BASE_URL,
  timeout: 30000,
})

// è¯·æ±‚æ‹¦æˆªå™¨
apiClient.interceptors.request.use(
  (config) => {
    const token = localStorage.getItem('token')
    if (token) {
      config.headers.Authorization = `Bearer ${token}`
    }
    return config
  },
  (error) => Promise.reject(error)
)

// å“åº”æ‹¦æˆªå™¨
apiClient.interceptors.response.use(
  (response) => response.data,
  (error) => {
    if (error.response?.status === 401) {
      // å¤„ç†æœªæˆæƒ
      window.location.href = '/login'
    }
    return Promise.reject(error)
  }
)

export default apiClient
```

**æ›¿ä»£æ–¹æ¡ˆ**:
- âŒ Fetch APIï¼ˆåŠŸèƒ½ä¸å¦‚ Axios å®Œå–„ï¼‰
- âŒ Kyï¼ˆè½»é‡ä½†åŠŸèƒ½æœ‰é™ï¼‰

---

### 6. WebSocket å®¢æˆ·ç«¯

#### 6.1 åŸç”Ÿ WebSocket + ReconnectingWebSocket

**æ¨èæ–¹æ¡ˆ**: **åŸç”Ÿ WebSocket + reconnecting-websocket**

**é€‰å‹ç†ç”±**:
- âœ… è½»é‡çº§ï¼Œæ— é¢å¤–ä¾èµ–
- âœ… å®Œå…¨æ§åˆ¶è¿æ¥é€»è¾‘
- âœ… æ”¯æŒè‡ªåŠ¨é‡è¿
- âœ… æ€§èƒ½ä¼˜ç§€

**å°è£…ç¤ºä¾‹**:
```typescript
// services/xmppClient.ts
import ReconnectingWebSocket from 'reconnecting-websocket'

class XMPPClient {
  private ws: ReconnectingWebSocket | null = null
  private reconnectAttempts = 0
  private maxReconnectAttempts = 10

  connect(url: string, protocols?: string[]) {
    this.ws = new ReconnectingWebSocket(url, protocols, {
      maxRetries: this.maxReconnectAttempts,
      connectionTimeout: 5000,
      maxReconnectionDelay: 10000,
      minReconnectionDelay: 1000,
      reconnectionDelayGrowFactor: 1.3,
    })

    this.ws.addEventListener('open', this.handleOpen.bind(this))
    this.ws.addEventListener('message', this.handleMessage.bind(this))
    this.ws.addEventListener('error', this.handleError.bind(this))
    this.ws.addEventListener('close', this.handleClose.bind(this))
  }

  private handleOpen() {
    console.log('WebSocket connected')
    this.reconnectAttempts = 0
    this.startHeartbeat()
  }

  private handleMessage(event: MessageEvent) {
    const data = JSON.parse(event.data)
    // å¤„ç†æ¶ˆæ¯
  }

  private handleError(error: Event) {
    console.error('WebSocket error:', error)
  }

  private handleClose() {
    console.log('WebSocket closed')
  }

  private startHeartbeat() {
    setInterval(() => {
      if (this.ws?.readyState === WebSocket.OPEN) {
        this.ws.send(JSON.stringify({ type: 'ping' }))
      }
    }, 30000)
  }

  send(data: any) {
    if (this.ws?.readyState === WebSocket.OPEN) {
      this.ws.send(JSON.stringify(data))
    }
  }

  disconnect() {
    this.ws?.close()
  }
}

export const xmppClient = new XMPPClient()
```

**æ›¿ä»£æ–¹æ¡ˆ**:
- âŒ Socket.ioï¼ˆåŠŸèƒ½è¿‡å¤šï¼Œä¸é€‚åˆ XMPPï¼‰
- âŒ SockJSï¼ˆéœ€è¦æœåŠ¡ç«¯æ”¯æŒï¼‰

---

### 7. æ•°æ®å­˜å‚¨

#### 7.1 Dexie.jsï¼ˆIndexedDB å°è£…ï¼‰

**æ¨èç‰ˆæœ¬**: **dexie 3.2+**

**é€‰å‹ç†ç”±**:
- âœ… IndexedDB çš„æœ€ä½³å°è£…åº“
- âœ… API ç®€æ´ï¼Œç±»ä¼¼ SQL
- âœ… TypeScript æ”¯æŒä¼˜ç§€
- âœ… æ”¯æŒäº‹åŠ¡å’Œç´¢å¼•
- âœ… æ€§èƒ½ä¼˜ç§€

**ä½¿ç”¨ç¤ºä¾‹**:
```typescript
// db/holderDB.ts
import Dexie, { Table } from 'dexie'

interface Message {
  id?: number
  roomId: string
  content: string
  timestamp: number
  senderId: string
}

interface LoginInfo {
  account: string
  password: string
  loginTime: number
}

class HolderDB extends Dexie {
  messages!: Table<Message, number>
  loginInfo!: Table<LoginInfo, string>

  constructor() {
    super('HolderDB')
    
    this.version(1).stores({
      messages: '++id, roomId, timestamp, senderId',
      loginInfo: 'account, loginTime',
    })
  }
}

export const db = new HolderDB()

// ä½¿ç”¨ç¤ºä¾‹
// æŸ¥è¯¢æ¶ˆæ¯
const messages = await db.messages
  .where('roomId')
  .equals(roomId)
  .sortBy('timestamp')

// æ’å…¥æ¶ˆæ¯
await db.messages.add({
  roomId: 'room1',
  content: 'Hello',
  timestamp: Date.now(),
  senderId: 'user1',
})
```

**æ›¿ä»£æ–¹æ¡ˆ**:
- âŒ idbï¼ˆAPI è¾ƒåº•å±‚ï¼‰
- âŒ localForageï¼ˆåŠŸèƒ½æœ‰é™ï¼‰

---

### 8. æ„å»ºå·¥å…·

#### 8.1 Viteï¼ˆå¼ºçƒˆæ¨èï¼‰

**æ¨èç‰ˆæœ¬**: **vite 5.0+**

**é€‰å‹ç†ç”±**:
- âœ… å¼€å‘æœåŠ¡å™¨å¯åŠ¨æå¿«ï¼ˆç§’çº§ï¼‰
- âœ… HMR çƒ­æ›´æ–°é€Ÿåº¦å¿«
- âœ… ç”Ÿäº§æ„å»ºä½¿ç”¨ Rollupï¼Œæ€§èƒ½ä¼˜ç§€
- âœ… é…ç½®ç®€å•ï¼Œå¼€ç®±å³ç”¨
- âœ… æ”¯æŒ TypeScriptã€Less ç­‰
- âœ… æ’ä»¶ç”Ÿæ€ä¸°å¯Œ

**é…ç½®ç¤ºä¾‹**:
```typescript
// vite.config.ts
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'
import { VitePWA } from 'vite-plugin-pwa'
import path from 'path'

export default defineConfig({
  plugins: [
    react(),
    VitePWA({
      registerType: 'autoUpdate',
      workbox: {
        globPatterns: ['**/*.{js,css,html,ico,png,svg}'],
      },
    }),
  ],
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './app/src'),
    },
  },
  css: {
    preprocessorOptions: {
      less: {
        javascriptEnabled: true,
      },
    },
  },
  build: {
    target: 'es2015',
    outDir: 'dist',
    rollupOptions: {
      output: {
        manualChunks: {
          'react-vendor': ['react', 'react-dom', 'react-router-dom'],
          'antd-vendor': ['antd'],
        },
      },
    },
  },
})
```

**æ›¿ä»£æ–¹æ¡ˆ**:
- âš ï¸ Webpack 5ï¼ˆå½“å‰ä½¿ç”¨ï¼Œä½†æ€§èƒ½ä¸å¦‚ Viteï¼‰
- âŒ Parcelï¼ˆåŠŸèƒ½ä¸å¦‚ Viteï¼‰

---

### 9. æ ·å¼æ–¹æ¡ˆ

#### 9.1 Less + CSS Modules

**æ¨èæ–¹æ¡ˆ**: **Less + CSS Modules**

**é€‰å‹ç†ç”±**:
- âœ… å½“å‰é¡¹ç›®ä½¿ç”¨ Less
- âœ… CSS Modules æä¾›ä½œç”¨åŸŸéš”ç¦»
- âœ… æ”¯æŒå˜é‡å’ŒåµŒå¥—
- âœ… TypeScript æ”¯æŒè‰¯å¥½

**ä½¿ç”¨ç¤ºä¾‹**:
```typescript
// Component.module.less
.container {
  padding: 20px;
  
  .title {
    font-size: 18px;
    color: #333;
  }
}

// Component.tsx
import styles from './Component.module.less'

const Component = () => {
  return (
    <div className={styles.container}>
      <h1 className={styles.title}>Title</h1>
    </div>
  )
}
```

**æ›¿ä»£æ–¹æ¡ˆ**:
- âš ï¸ Tailwind CSSï¼ˆéœ€è¦é‡æ„æ ·å¼ï¼‰
- âš ï¸ Styled Componentsï¼ˆCSS-in-JSï¼‰

---

### 10. æµ‹è¯•æ¡†æ¶

#### 10.1 Vitest + React Testing Library

**æ¨èç‰ˆæœ¬**: **vitest 1.0+ / @testing-library/react 14.0+**

**é€‰å‹ç†ç”±**:
- âœ… Vitest ä¸ Vite é›†æˆå¥½ï¼Œé€Ÿåº¦å¿«
- âœ… React Testing Library æ˜¯ React æµ‹è¯•æ ‡å‡†
- âœ… TypeScript æ”¯æŒä¼˜ç§€
- âœ… API ç®€æ´

**é…ç½®ç¤ºä¾‹**:
```typescript
// vitest.config.ts
import { defineConfig } from 'vitest/config'
import react from '@vitejs/plugin-react'

export default defineConfig({
  plugins: [react()],
  test: {
    environment: 'jsdom',
    globals: true,
    setupFiles: './tests/setup.ts',
  },
})
```

**æ›¿ä»£æ–¹æ¡ˆ**:
- âš ï¸ Jestï¼ˆå½“å‰ä½¿ç”¨ï¼Œä½†é€Ÿåº¦è¾ƒæ…¢ï¼‰

---

### 11. PWA æ”¯æŒ

#### 11.1 Vite PWA Plugin

**æ¨èç‰ˆæœ¬**: **vite-plugin-pwa 0.17+**

**é€‰å‹ç†ç”±**:
- âœ… ä¸ Vite é›†æˆå¥½
- âœ… è‡ªåŠ¨ç”Ÿæˆ Service Worker
- âœ… æ”¯æŒç¦»çº¿ç¼“å­˜
- âœ… é…ç½®ç®€å•

**é…ç½®ç¤ºä¾‹**:
```typescript
// vite.config.ts
import { VitePWA } from 'vite-plugin-pwa'

export default defineConfig({
  plugins: [
    VitePWA({
      registerType: 'autoUpdate',
      includeAssets: ['favicon.ico', 'apple-touch-icon.png'],
      manifest: {
        name: 'Holder PAAS',
        short_name: 'Holder',
        description: 'Holder PAAS Web Application',
        theme_color: '#1890ff',
        icons: [
          {
            src: 'pwa-192x192.png',
            sizes: '192x192',
            type: 'image/png',
          },
          {
            src: 'pwa-512x512.png',
            sizes: '512x512',
            type: 'image/png',
          },
        ],
      },
      workbox: {
        globPatterns: ['**/*.{js,css,html,ico,png,svg}'],
        runtimeCaching: [
          {
            urlPattern: /^https:\/\/api\./,
            handler: 'NetworkFirst',
            options: {
              cacheName: 'api-cache',
              expiration: {
                maxEntries: 50,
                maxAgeSeconds: 60 * 60 * 24, // 24 hours
              },
            },
          },
        ],
      },
    }),
  ],
})
```

---

### 12. å…¶ä»–å·¥å…·åº“

#### 12.1 å·¥å…·å‡½æ•°åº“

**æ¨è**: **lodash-es**ï¼ˆæŒ‰éœ€å¯¼å…¥ï¼‰

**é€‰å‹ç†ç”±**:
- âœ… å½“å‰ä½¿ç”¨ lodash
- âœ… lodash-es æ”¯æŒ Tree Shaking
- âœ… åŠŸèƒ½ä¸°å¯Œ

**ä½¿ç”¨ç¤ºä¾‹**:
```typescript
// æŒ‰éœ€å¯¼å…¥ï¼Œæ”¯æŒ Tree Shaking
import { debounce, throttle } from 'lodash-es'
```

---

#### 12.2 æ—¶é—´å¤„ç†

**æ¨è**: **dayjs**ï¼ˆæ›¿ä»£ moment.jsï¼‰

**é€‰å‹ç†ç”±**:
- âœ… ä½“ç§¯å°ï¼ˆ2KB vs moment.js çš„ 67KBï¼‰
- âœ… API ä¸ moment.js å…¼å®¹
- âœ… æ€§èƒ½æ›´å¥½

**è¿ç§»å»ºè®®**:
```typescript
// moment.js
import moment from 'moment'
moment().format('YYYY-MM-DD')

// dayjs
import dayjs from 'dayjs'
dayjs().format('YYYY-MM-DD')
```

---

#### 12.3 è¡¨å•å¤„ç†

**æ¨è**: **React Hook Form**

**é€‰å‹ç†ç”±**:
- âœ… æ€§èƒ½ä¼˜ç§€ï¼ˆéå—æ§ç»„ä»¶ï¼‰
- âœ… ä½“ç§¯å°
- âœ… TypeScript æ”¯æŒä¼˜ç§€
- âœ… éªŒè¯åº“ä¸°å¯Œ

---

#### 12.4 è™šæ‹Ÿåˆ—è¡¨

**æ¨è**: **@tanstack/react-virtual**

**é€‰å‹ç†ç”±**:
- âœ… å½“å‰ä½¿ç”¨ react-window
- âœ… @tanstack/react-virtual æ›´ç°ä»£
- âœ… æ€§èƒ½ä¼˜ç§€
- âœ… API æ›´çµæ´»

---

## æŠ€æœ¯æ ˆå¯¹æ¯”

### å½“å‰æŠ€æœ¯æ ˆ vs æ¨èæŠ€æœ¯æ ˆ

| æŠ€æœ¯åˆ†ç±» | å½“å‰ç‰ˆæœ¬ | æ¨èç‰ˆæœ¬ | è¿ç§»éš¾åº¦ |
|---------|---------|---------|---------|
| **React** | 16.13.1 | 18.2+ | ğŸŸ¡ ä¸­ç­‰ |
| **TypeScript** | 4.9.5 | 5.0+ | ğŸŸ¢ ä½ |
| **Redux** | 4.0.5 | Redux Toolkit 2.0+ | ğŸŸ¡ ä¸­ç­‰ |
| **MobX** | 6.13.1 | ä¿æŒ / è¿ç§»åˆ° Zustand | ğŸŸ¡ ä¸­ç­‰ |
| **React Router** | 5.1.2 | 6.20+ | ğŸŸ¡ ä¸­ç­‰ |
| **Ant Design** | 4.18.4 | 5.12+ | ğŸŸ¡ ä¸­ç­‰ |
| **Webpack** | 4.46.0 | Vite 5.0+ | ğŸŸ¡ ä¸­ç­‰ |
| **Axios** | 0.24.0 | 1.6+ | ğŸŸ¢ ä½ |
| **Moment.js** | 2.27.0 | dayjs 1.11+ | ğŸŸ¢ ä½ |

---

## è¿ç§»å»ºè®®

### é˜¶æ®µä¸€ï¼šåŸºç¡€å‡çº§ï¼ˆç¬¬1-2å‘¨ï¼‰

1. **å‡çº§ TypeScript** â†’ 5.0+
2. **å‡çº§ Axios** â†’ 1.6+
3. **æ›¿æ¢ Moment.js** â†’ dayjs
4. **å‡çº§æ„å»ºå·¥å…·** â†’ Viteï¼ˆå¯é€‰ï¼Œå»ºè®®ï¼‰

### é˜¶æ®µäºŒï¼šæ¡†æ¶å‡çº§ï¼ˆç¬¬3-4å‘¨ï¼‰

1. **å‡çº§ React** â†’ 18.2+
   - å…ˆå‡çº§åˆ° 17.xï¼Œå†å‡çº§åˆ° 18.x
   - ä½¿ç”¨ `createRoot` API
   - å¤„ç† Breaking Changes

2. **å‡çº§ React Router** â†’ 6.20+
   - é€æ­¥è¿ç§»è·¯ç”±é…ç½®
   - ä½¿ç”¨æ–°çš„ API

3. **å‡çº§ Ant Design** â†’ 5.12+
   - æ³¨æ„æ ·å¼å˜åŒ–
   - è°ƒæ•´ä¸»é¢˜é…ç½®

### é˜¶æ®µä¸‰ï¼šçŠ¶æ€ç®¡ç†é‡æ„ï¼ˆç¬¬5-6å‘¨ï¼‰

1. **è¿ç§»åˆ° Redux Toolkit**
   - é€æ­¥è¿ç§» Redux ä»£ç 
   - ä½¿ç”¨ `createSlice` ç®€åŒ–ä»£ç 

2. **å¼•å…¥ Zustand**
   - ç”¨äºç»„ä»¶çº§çŠ¶æ€
   - é€æ­¥æ›¿æ¢ MobXï¼ˆå¯é€‰ï¼‰

3. **å¼•å…¥ React Query**
   - ç”¨äºæœåŠ¡ç«¯çŠ¶æ€ç®¡ç†
   - æ›¿æ¢éƒ¨åˆ† Redux ä»£ç 

### é˜¶æ®µå››ï¼šæ–°åŠŸèƒ½å¼€å‘ï¼ˆç¬¬7å‘¨å¼€å§‹ï¼‰

1. **IndexedDB å°è£…**
   - ä½¿ç”¨ Dexie.js
   - å®ç°æ•°æ®å­˜å‚¨å±‚

2. **WebSocket å®¢æˆ·ç«¯**
   - å°è£… WebSocket
   - å®ç°é‡è¿æœºåˆ¶

3. **PWA æ”¯æŒ**
   - é…ç½® Service Worker
   - å®ç°ç¦»çº¿åŠŸèƒ½

---

## ç¤ºä¾‹ä»£ç 

### å®Œæ•´é¡¹ç›®ç»“æ„

```
holder-paas-web/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ api/                 # API æ¥å£
â”‚   â”‚   â”œâ”€â”€ request.ts       # Axios å°è£…
â”‚   â”‚   â””â”€â”€ message.ts      # æ¶ˆæ¯ API
â”‚   â”œâ”€â”€ components/          # å…¬å…±ç»„ä»¶
â”‚   â”œâ”€â”€ pages/               # é¡µé¢ç»„ä»¶
â”‚   â”œâ”€â”€ stores/              # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ slices/         # Redux Toolkit slices
â”‚   â”‚   â””â”€â”€ zustand/        # Zustand stores
â”‚   â”œâ”€â”€ hooks/               # è‡ªå®šä¹‰ Hooks
â”‚   â”œâ”€â”€ db/                  # IndexedDB
â”‚   â”‚   â””â”€â”€ holderDB.ts     # Dexie æ•°æ®åº“
â”‚   â”œâ”€â”€ services/            # æœåŠ¡å±‚
â”‚   â”‚   â””â”€â”€ xmppClient.ts   # XMPP å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ utils/               # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ styles/              # å…¨å±€æ ·å¼
â”‚   â””â”€â”€ main.tsx             # å…¥å£æ–‡ä»¶
â”œâ”€â”€ public/                   # é™æ€èµ„æº
â”œâ”€â”€ vite.config.ts           # Vite é…ç½®
â”œâ”€â”€ tsconfig.json            # TypeScript é…ç½®
â””â”€â”€ package.json             # ä¾èµ–é…ç½®
```

### package.json ç¤ºä¾‹

```json
{
  "name": "holder-paas-web",
  "version": "1.0.0",
  "dependencies": {
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "react-router-dom": "^6.20.0",
    "@reduxjs/toolkit": "^2.0.0",
    "zustand": "^4.5.0",
    "@tanstack/react-query": "^5.17.0",
    "antd": "^5.12.0",
    "axios": "^1.6.0",
    "dexie": "^3.2.4",
    "reconnecting-websocket": "^4.7.0",
    "dayjs": "^1.11.10",
    "lodash-es": "^4.17.21"
  },
  "devDependencies": {
    "@types/react": "^18.2.0",
    "@types/react-dom": "^18.2.0",
    "typescript": "^5.3.0",
    "vite": "^5.0.0",
    "@vitejs/plugin-react": "^4.2.0",
    "vite-plugin-pwa": "^0.17.0",
    "vitest": "^1.0.0",
    "@testing-library/react": "^14.1.0",
    "less": "^4.2.0"
  }
}
```

---

## æ€»ç»“

### æ¨èæŠ€æœ¯æ ˆï¼ˆæœ€ç»ˆç‰ˆï¼‰

| æŠ€æœ¯åˆ†ç±» | æ¨èæ–¹æ¡ˆ | ç‰ˆæœ¬ |
|---------|---------|------|
| **å‰ç«¯æ¡†æ¶** | React | 18.2+ |
| **å¼€å‘è¯­è¨€** | TypeScript | 5.0+ |
| **çŠ¶æ€ç®¡ç†** | Redux Toolkit + Zustand + React Query | RTK 2.0+ / Zustand 4.5+ / RQ 5.0+ |
| **è·¯ç”±** | React Router | 6.20+ |
| **UI ç»„ä»¶åº“** | Ant Design | 5.12+ |
| **HTTP å®¢æˆ·ç«¯** | Axios | 1.6+ |
| **WebSocket** | åŸç”Ÿ WebSocket + ReconnectingWebSocket | - |
| **æ•°æ®å­˜å‚¨** | Dexie.js | 3.2+ |
| **æ„å»ºå·¥å…·** | Vite | 5.0+ |
| **æ ·å¼æ–¹æ¡ˆ** | Less + CSS Modules | - |
| **æµ‹è¯•æ¡†æ¶** | Vitest + React Testing Library | - |
| **PWA** | Vite PWA Plugin | 0.17+ |
| **å·¥å…·åº“** | dayjs, lodash-es | - |

### å…³é”®ä¼˜åŠ¿

1. âœ… **æ€§èƒ½ä¼˜ç§€**: Vite + React 18 + ä»£ç åˆ†å‰²
2. âœ… **å¼€å‘ä½“éªŒå¥½**: Vite HMR + TypeScript + å®Œå–„å·¥å…·é“¾
3. âœ… **çŠ¶æ€ç®¡ç†çµæ´»**: Redux Toolkitï¼ˆå…¨å±€ï¼‰+ Zustandï¼ˆç»„ä»¶ï¼‰+ React Queryï¼ˆæœåŠ¡ç«¯ï¼‰
4. âœ… **ç°ä»£åŒ–**: ä½¿ç”¨æœ€æ–°ç¨³å®šç‰ˆæœ¬ï¼Œé•¿æœŸç»´æŠ¤
5. âœ… **è¿ç§»æˆæœ¬å¯æ§**: æ¸è¿›å¼å‡çº§ï¼Œé™ä½é£é™©

---

**æ–‡æ¡£ç»“æŸ**

