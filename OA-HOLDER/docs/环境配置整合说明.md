# 环境配置整合说明

## 整合概述

已将 `dev.config.ts` 中的三套环境配置（dev、re、prod）整合到统一的环境配置系统中，项目会根据 `VITE_APP_ENV` 环境变量自动选择对应的配置。

## 整合内容

### 1. 配置文件结构

```
src/renderer/config/
├── dev.config.ts      # 原始环境配置（dev、re、prod）
├── env.ts             # 环境配置管理器（自动选择配置）
└── index.ts           # 统一导出
```

### 2. 工作原理

1. **环境识别**：通过 `VITE_APP_ENV` 或 `import.meta.env.MODE` 识别当前环境
2. **配置选择**：根据环境自动从 `dev.config.ts` 中选择对应的配置
3. **统一接口**：提供统一的 `envConfig` 对象访问所有配置

### 3. 环境映射

- `development` → 使用 `dev.config.ts` 中的 `dev.variables`
- `re` → 使用 `dev.config.ts` 中的 `re.variables`
- `production` → 使用 `dev.config.ts` 中的 `prod.variables`

## 使用方式

### 基础使用

```typescript
import envConfig from '@/config/env';

// 访问所有配置变量
const apiHost = envConfig.variables.API_HOST;
const keycloakService = envConfig.variables.KEYCLOAK_SERVICE;

// 使用便捷属性
const apiUrl = envConfig.apiBaseUrl; // 自动拼接的完整 API 地址
const title = envConfig.title; // 产品中文名
```

### 环境判断

```typescript
import { isDevelopment, isRe, isProduction } from '@/config/env';

if (isDevelopment()) {
  // 开发环境逻辑
}
```

### 直接访问变量

```typescript
import { envVariables } from '@/config/env';

const apiHost = envVariables.API_HOST;
```

## 配置项说明

所有配置项都通过 `envConfig.variables` 访问，包括：

- **基础配置**
  - `PRODUCT_NAME_CH` - 产品中文名
  - `PRODUCT_NAME` - 产品英文名
  
- **API 配置**
  - `API_PROTOCOL` - API 协议
  - `API_HOST` - API 主机
  - `API_BASE_PATH` - API 基础路径
  - `API_FILE_HOST` - 文件服务地址
  
- **WebSocket 配置**
  - `WEBSOCKET_URL` - WebSocket 地址
  - `PLAN_WS_URL` - 计划 WebSocket 地址
  - `PLAN_WS_URL_BETA` - 计划 WebSocket Beta 地址
  
- **认证配置**
  - `KEYCLOAK_SERVICE` - Keycloak 服务地址
  - `KEYCLOAK_REALM` - Keycloak Realm
  - `KEYCLOAK_CLIENT` - Keycloak Client ID
  
- **其他服务**
  - `BOSH_SERVICE` - BOSH 服务
  - `ROOM_SERVICE` - 房间服务
  - `ORG_URL` - 组织服务
  - `UPGRADE_URL` - 升级服务
  - `CRASH_REPORT_SERVICE` - 崩溃上报服务
  - ... 更多配置项

## 便捷属性

`envConfig` 提供了一些便捷属性，自动处理配置：

- `envConfig.apiBaseUrl` - 自动拼接：`API_PROTOCOL + API_HOST + API_BASE_PATH`
- `envConfig.title` - 产品中文名（`PRODUCT_NAME_CH`）
- `envConfig.wsUrl` - WebSocket 地址（`WEBSOCKET_URL`）
- `envConfig.debug` - 调试模式（开发环境默认为 true）

## 构建命令

### 开发环境（自动使用 dev 配置）
```bash
npm run dev
```

### RE 环境构建
```bash
npm run build:re
npm run dist:re
```

### 生产环境构建
```bash
npm run build:prod
npm run dist
```

## 注意事项

1. **无需修改代码**：切换环境只需修改构建命令，代码会自动使用对应配置
2. **类型安全**：所有配置都有 TypeScript 类型定义
3. **配置来源**：配置统一从 `dev.config.ts` 读取，保持单一数据源
4. **环境变量**：`VITE_APP_ENV` 用于控制环境选择，在 `.env.*` 文件中配置

## 迁移指南

如果之前直接使用 `dev.config.ts`，可以这样迁移：

### 之前
```typescript
import { env } from './config/dev.config';
const apiHost = env.dev.variables.API_HOST;
```

### 现在（推荐）
```typescript
import envConfig from '@/config/env';
const apiHost = envConfig.variables.API_HOST;
```

### 或者（保持兼容）
```typescript
import { devConfigs } from '@/config';
const apiHost = devConfigs.dev.variables.API_HOST;
```

