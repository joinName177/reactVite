# 安装程序使用指南

## 文件类型说明

打包后会生成两种类型的文件：

### 1. NSIS 安装程序（推荐使用）
**文件名格式**：`holder Setup x.x.x-x64.exe` 或 `holder Setup x.x.x-ia32.exe`

**特点**：
- ✅ 显示安装向导界面
- ✅ 可以选择安装目录
- ✅ 创建桌面和开始菜单快捷方式
- ✅ 可以卸载程序
- ✅ 安装到系统目录

**使用方法**：
1. 双击运行 `holder Setup x.x.x-x64.exe`（64位）或 `holder Setup x.x.x-ia32.exe`（32位）
2. 按照安装向导提示操作
3. 选择安装目录（默认：`C:\Program Files\holder`）
4. 选择是否创建桌面快捷方式
5. 点击"安装"完成安装

### 2. 便携版（Portable）
**文件名格式**：`holder x.x.x-x64.exe` 或 `holder x.x.x-ia32.exe`

**特点**：
- ⚠️ 直接运行，无需安装
- ⚠️ 不创建快捷方式
- ⚠️ 不写入注册表
- ⚠️ 适合临时使用或U盘携带

**使用方法**：
- 直接双击运行即可，无需安装过程

## 如何区分安装程序和便携版

### 方法1：看文件名
- **安装程序**：文件名包含 `Setup`，例如：`holder Setup 1.0.0-x64.exe`
- **便携版**：文件名不包含 `Setup`，例如：`holder 1.0.0-x64.exe`

### 方法2：看文件大小
- **安装程序**：通常较大（包含安装程序代码）
- **便携版**：相对较小（只是打包的应用）

### 方法3：运行测试
- **安装程序**：运行后会显示安装向导界面
- **便携版**：运行后直接启动应用

## 当前配置说明

### NSIS 安装程序配置
当前配置的安装程序特性：
- ✅ **非一键安装**（`oneClick: false`）- 显示完整的安装向导
- ✅ **允许选择安装目录**（`allowToChangeInstallationDirectory: true`）
- ✅ **允许提升权限**（`allowElevation: true`）- 可以安装到系统目录
- ✅ **创建桌面快捷方式**（`createDesktopShortcut: "always"`）
- ✅ **创建开始菜单快捷方式**（`createStartMenuShortcut: true`）
- ✅ **安装后运行程序**（`runAfterFinish: true`）

### 如何只生成安装程序（不生成便携版）

如果只想生成安装程序，修改 `package.json` 中的配置：

```json
"win": {
  "target": [
    {
      "target": "nsis",
      "arch": ["x64", "ia32"]
    }
  ]
}
```

移除 `portable` 配置即可。

## 安装程序界面说明

### 安装向导步骤：
1. **欢迎页面** - 显示欢迎信息
2. **许可协议** - 显示软件许可（如果有）
3. **选择安装位置** - 可以选择安装目录
4. **选择组件** - 选择要安装的组件（快捷方式等）
5. **准备安装** - 显示安装摘要
6. **正在安装** - 显示安装进度
7. **完成** - 安装完成，可以选择立即运行程序

## 卸载程序

安装程序会在以下位置创建卸载程序：
- **Windows 10/11**：`设置` → `应用` → `已安装的应用` → 找到 `holder` → 点击卸载
- **控制面板**：`程序和功能` → 找到 `holder` → 右键卸载

## 常见问题

### Q: 为什么运行后没有显示安装向导？
**A**: 可能运行的是便携版（文件名不包含 `Setup`），请使用安装程序版本。

### Q: 如何只生成安装程序，不生成便携版？
**A**: 修改 `package.json`，移除 `portable` 配置，只保留 `nsis`。

### Q: 安装程序可以自定义吗？
**A**: 可以，修改 `package.json` 中的 `build.nsis` 配置项。

### Q: 如何添加安装程序的图标？
**A**: 在 `build/` 目录放置 `icon.ico` 文件，然后在配置中添加：
```json
"nsis": {
  "installerIcon": "build/icon.ico",
  "uninstallerIcon": "build/icon.ico"
}
```

## 重新打包

如果修改了配置，需要重新打包：

```bash
npm run dist:win
```

或者只打包安装程序（不包含便携版）：

```bash
npm run build && electron-builder --win --x64 --ia32 --config.win.target=nsis
```

