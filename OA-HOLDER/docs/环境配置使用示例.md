# 环境配置使用示例

## 概述

项目已整合 `dev.config.ts` 中的三套环境配置（dev、re、prod），根据 `VITE_APP_ENV` 环境变量自动选择对应的配置。

## 基本使用

### 1. 导入环境配置

```typescript
import envConfig, { isDevelopment, isRe, isProduction, envVariables } from '@/config/env';
```

### 2. 访问环境变量

```typescript
// 方式一：通过 envConfig.variables 访问所有配置
const apiHost = envConfig.variables.API_HOST;
const keycloakService = envConfig.variables.KEYCLOAK_SERVICE;
const productName = envConfig.variables.PRODUCT_NAME_CH;

// 方式二：直接导入 envVariables（便捷方式）
import { envVariables } from '@/config/env';
const apiHost = envVariables.API_HOST;

// 方式三：使用便捷属性
const apiBaseUrl = envConfig.apiBaseUrl; // 自动拼接的完整 API 地址
const wsUrl = envConfig.wsUrl; // WebSocket 地址
const title = envConfig.title; // 产品中文名
```

### 3. 环境判断

```typescript
import { isDevelopment, isRe, isProduction } from '@/config/env';

if (isDevelopment()) {
  console.log('当前是开发环境');
  // 开发环境特定逻辑
}

if (isRe()) {
  console.log('当前是 RE 环境');
  // RE 环境特定逻辑
}

if (isProduction()) {
  console.log('当前是生产环境');
  // 生产环境特定逻辑
}
```

## 实际应用示例

### API 请求

```typescript
import envConfig from '@/config/env';

// 使用配置中的 API 地址
const response = await fetch(`${envConfig.apiBaseUrl}/api/users`, {
  method: 'GET',
  headers: {
    'Authorization': `Bearer ${token}`,
  },
});
```

### Keycloak 认证

```typescript
import envConfig from '@/config/env';

const keycloakConfig = {
  url: envConfig.variables.KEYCLOAK_SERVICE,
  realm: envConfig.variables.KEYCLOAK_REALM,
  clientId: envConfig.variables.KEYCLOAK_CLIENT,
};
```

### WebSocket 连接

```typescript
import envConfig from '@/config/env';

const ws = new WebSocket(envConfig.variables.WEBSOCKET_URL);

ws.onopen = () => {
  console.log('WebSocket 连接已建立');
};
```

### 文件上传

```typescript
import envConfig from '@/config/env';

const uploadFile = async (file: File) => {
  const formData = new FormData();
  formData.append('file', file);
  
  const response = await fetch(`${envConfig.variables.API_FILE_HOST}/upload`, {
    method: 'POST',
    body: formData,
  });
  
  return response.json();
};
```

### 条件渲染（根据环境）

```typescript
import { isDevelopment } from '@/config/env';

const MyComponent = () => {
  return (
    <div>
      {isDevelopment() && (
        <div>这是开发环境的调试信息</div>
      )}
      <div>正常内容</div>
    </div>
  );
};
```

### 日志记录（根据环境）

```typescript
import envConfig from '@/config/env';

const log = (message: string, data?: any) => {
  if (envConfig.debug) {
    console.log(`[${envConfig.env}]`, message, data);
  }
  
  // 生产环境可以发送到日志服务
  if (envConfig.env === 'production') {
    // 发送到 TRACK_SERVICE
    fetch(`${envConfig.variables.TRACK_SERVICE}`, {
      method: 'POST',
      body: JSON.stringify({ message, data }),
    });
  }
};
```

## 可用配置项

所有环境配置项都在 `envConfig.variables` 中可用：

- `PRODUCT_NAME_CH` - 产品中文名
- `PRODUCT_NAME` - 产品英文名
- `API_PROTOCOL` - API 协议（https:// 或 http://）
- `API_HOST` - API 主机地址
- `API_BASE_PATH` - API 基础路径
- `API_FILE_HOST` - 文件服务地址
- `WEBSOCKET_URL` - WebSocket 地址
- `KEYCLOAK_SERVICE` - Keycloak 服务地址
- `KEYCLOAK_REALM` - Keycloak Realm
- `KEYCLOAK_CLIENT` - Keycloak Client ID
- `BOSH_SERVICE` - BOSH 服务地址
- `ROOM_SERVICE` - 房间服务地址
- `ORG_URL` - 组织服务地址
- `UPGRADE_URL` - 升级服务地址
- `CRASH_REPORT_SERVICE` - 崩溃上报服务
- ... 更多配置项请查看 `dev.config.ts`

## 注意事项

1. **环境自动切换**：根据 `VITE_APP_ENV` 自动选择对应配置，无需手动修改代码
2. **类型安全**：所有配置都有 TypeScript 类型定义，IDE 会提供自动补全
3. **便捷属性**：`apiBaseUrl` 会自动拼接 `API_PROTOCOL` + `API_HOST` + `API_BASE_PATH`
4. **调试模式**：开发环境默认开启调试模式，可通过 `envConfig.debug` 判断

